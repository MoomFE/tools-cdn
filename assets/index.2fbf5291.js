import{u as Z,_ as ee}from"./useFileChoose.c907e76f.js";import{L as te,M as S,a1 as se,a2 as ne,Q as L,o as m,A as g,h as d,w as h,i as r,H as $,j as p,E as z,J as V,R as k,$ as oe,a3 as re,G as y,a as b,I as E,a4 as B,S as ae,a5 as U,a6 as ce,a7 as ie,a8 as le,a9 as ue,B as de,g as I,aa as pe,ab as _e,X as P,Z as T}from"./vendor.2a4e4c2a.js";import{_ as H}from"./plugin-vue_export-helper.21dcd24c.js";function me({props:e,emit:t}){const s=te(e.value);function n(o){if(s.value)return;const c=se(o.clipboardData.items,{kind:"string",type:"text/plain"});c&&(o.preventDefault(),c.getAsString(i=>{a(i)||(s.value=i)}))}function a(o){if(o&&o.includes("</svg>"))return t("update:value",o),ne(()=>s.value="",200),!0}return S(()=>s.value,a),{internalValue:s,onPaste:n}}const fe={class:"flex items-center"},ge={class:"ml-1"},ve=p("div",{class:"px-3"},"\u6216\u8005",-1),he={class:"flex items-center"},be={props:{value:String},emits:["update:value"],setup(e,{emit:t}){const s=e,n=L("file"),{internalValue:a,onPaste:o}=me({props:s,emit:t}),{result:c,loading:i,chooseFile:l}=Z(n);return S(c,u=>{u&&t("update:value",u)}),(u,_)=>{const f=ee;return m(),g("div",fe,[d(r(V),{type:"primary",disabled:r(i),onClick:r(l)},{default:h(()=>[d(r($),{class:"text-xl"},{default:h(()=>[d(f)]),_:1}),p("span",ge,z(r(i)?"\u6587\u4EF6\u8BFB\u53D6\u4E2D...":"\u9009\u62E9 SVG \u6587\u4EF6"),1)]),_:1},8,["disabled","onClick"]),ve,p("div",he,[d(r(oe),{value:r(a),"onUpdate:value":_[0]||(_[0]=v=>k(a)?a.value=v:null),placeholder:"\u7C98\u8D34 SVG \u4EE3\u7801",clearable:"",onPaste:r(o)},null,8,["value","onPaste"])]),p("input",{ref:(v,w)=>{w.file=v,k(n)&&(n.value=v)},type:"file",accept:".svg",hidden:""},null,512)])}}},we={class:"flex"},ye=p("div",{class:"grow"},null,-1),xe={key:0,class:"flex items-center"},Se=p("span",{class:"ml-2"},"\u6BD4\u5BF9\u6A21\u5F0F",-1);function Me(e,{emit:t}){const s=e;return(n,a)=>(m(),g("div",we,[ye,r(j)?(m(),g("div",xe,[d(r(re),{value:s.contrastMode,"onUpdate:value":a[0]||(a[0]=o=>t("update:contrastMode",o))},null,8,["value"]),Se])):y("",!0)]))}const j=CSS.supports("clip-path: polygon(0 0)")&&CSS.supports("left: var(--left)"),$e={data:()=>({supportsContrastMode:j})},Ee=Object.assign($e,{props:{contrastMode:Boolean},emits:["update:contrastMode"],setup:Me}),ke={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},Ce=p("path",{d:"M10 17l5-5l-5-5v10z",fill:"currentColor"},null,-1),Re=[Ce];function Le(e,t){return m(),g("svg",ke,Re)}var ze={name:"mdi-menu-right",render:Le};const Pe={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},je=p("path",{d:"M14 7l-5 5l5 5V7z",fill:"currentColor"},null,-1),Ae=[je];function Oe(e,t){return m(),g("svg",Pe,Ae)}var Ne={name:"mdi-menu-left",render:Oe};const Ve={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},Be=p("path",{d:"M4 15V9h8V4.16L19.84 12L12 19.84V15H4z",fill:"currentColor"},null,-1),Ue=[Be];function Ie(e,t){return m(),g("svg",Ve,Ue)}var Te={name:"mdi-arrow-right-bold",render:Ie};const He={class:"s-responsive"},De={props:{aspectRatio:[String,Number],sizerClass:String,contentClass:String},setup(e){const t=e,s=CSS.supports("aspect-ratio: 1"),n=b(()=>Number(t.aspectRatio)),a=b(()=>!s&&n.value?{paddingBottom:`${1/n.value*100}%`}:null),o=b(()=>s&&n.value?{aspectRatio:n.value}:null);return(c,i)=>(m(),g("div",He,[r(a)?(m(),g("div",{key:0,class:E(["s-responsive-sizer",e.sizerClass]),style:B(r(a))},null,6)):y("",!0),p("div",{class:E(["s-responsive-content",e.contentClass]),style:B(r(o))},[ae(c.$slots,"default",{},void 0,!0)],6)]))}};var D=H(De,[["__scopeId","data-v-12282468"]]);const We={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},Fe=p("path",{d:"M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7l7-7z",fill:"currentColor"},null,-1),Ge=[Fe];function Ye(e,t){return m(),g("svg",We,Ge)}var Xe={name:"mdi-download",render:Ye};const qe={class:"flex gap-2 items-center"},Je={class:"flex p-2 text-sm leading-none text-white border border-black rounded bg-black bg-opacity-65"},Ke=["textContent"],Qe=["textContent"],Ze=["href"],W={props:{svg:Object,label:String},setup(e){const t=e,s=b(()=>t.svg.code||""),n=b(()=>{const o=s.value.length;return o<1024?`${o} B`:`${(o/1024).toFixed(2)} KB`}),a=b(()=>s.value?URL.createObjectURL(new Blob([s.value],{type:"image/svg+xml"})):null);return S(a,(o,c)=>{c&&URL.revokeObjectURL(c)}),U(()=>{a.value&&URL.revokeObjectURL(a.value)}),(o,c)=>{const i=Xe;return m(),g("div",qe,[p("div",Je,[p("span",{class:"mr-1",textContent:z(t.label)},null,8,Ke),p("span",{textContent:z(r(n))},null,8,Qe)]),r(a)?(m(),g("a",{key:0,href:r(a),download:"download"},[d(r(V),{type:"primary",circle:""},{default:h(()=>[d(r($),{class:"text-lg"},{default:h(()=>[d(i)]),_:1})]),_:1})],8,Ze)):y("",!0)])}}};function et({props:e},t,s){const n=ce("--split-line-position",t),{pressed:a}=ie({target:s}),o=b(()=>a.value&&e.contrastMode),{x:c}=le();ue(()=>{if(o.value){const i=t.value.getBoundingClientRect(),l=parseFloat(document.documentElement.style.zoom||1),u=c.value-i.left*l,_=i.width*l;u<=0?n.value="0":u>=_?n.value="100%":n.value=`${u/_*100}%`}}),S(()=>e.contrastMode,i=>{i&&(n.value="50%")}),S(()=>o.value,i=>{document.documentElement.style.cursor=i?"ew-resize":"",document.body.style.pointerEvents=i?"none":""}),U(()=>{document.documentElement.style.cursor="",document.body.style.pointerEvents=""})}const tt={class:"iframe-wrap w-full h-full pointer-events-none"},st=["src"],nt={class:"iframe-wrap w-full h-full pointer-events-none"},ot=["src"],rt={class:"w-9 h-9 grid grid-cols-2 items-center rounded-full bg-black absolute top-0 right-auto bottom-0 -left-3 m-auto"},at={props:{contrastMode:Boolean,originalSvg:Object,compressSvg:Object},setup(e){const t=e,{contrastMode:s,originalSvg:n,compressSvg:a}=de(t),o=L("preview"),c=L("splitLine"),i=b(()=>!!(n.value.code&&!a.value.code));return et({props:t},o,c),(l,u)=>{const _=Te,f=Ne,v=ze;return m(),I(r(pe),{show:r(i)},{default:h(()=>[p("div",{ref:(w,R)=>{R.preview=w,k(o)&&(o.value=w)},class:E(["svg-preview items-center select-none relative",{flex:!r(s)}])},[d(D,{class:E(["responsive original",{"contrast-mode w-full transform-gpu":r(s)}]),"aspect-ratio":r(s)?2:1},{default:h(()=>[p("div",tt,[r(n).base64?(m(),g("iframe",{key:0,class:"w-full h-full border-none overflow-hidden",src:r(n).base64,scrolling:"no",sandbox:"allow-scripts"},null,8,st)):y("",!0)])]),_:1},8,["class","aspect-ratio"]),r(s)?y("",!0):(m(),I(r($),{key:0,class:"text-4xl opacity-60 mx-2"},{default:h(()=>[d(_)]),_:1})),d(D,{class:E(["responsive compress",{"contrast-mode w-full transform-gpu absolute top-0 right-0":r(s)}]),"aspect-ratio":r(s)?2:1},{default:h(()=>[p("div",nt,[r(a).base64?(m(),g("iframe",{key:0,class:"w-full h-full border-none overflow-hidden",src:r(a).base64,scrolling:"no",sandbox:"allow-scripts"},null,8,ot)):y("",!0)])]),_:1},8,["class","aspect-ratio"]),d(W,{class:"absolute top-2 left-2",svg:r(n),label:"\u538B\u7F29\u524D"},null,8,["svg"]),d(W,{class:"absolute top-2 right-2 flex-row-reverse",svg:r(a),label:"\u538B\u7F29\u540E"},null,8,["svg"]),r(s)?(m(),g("div",{key:1,ref:(w,R)=>{R.splitLine=w,k(c)&&(c.value=w)},class:"split-line w-3 h-full cursor-ew-resize absolute top-0 transform-gpu -translate-x-2/4 bg-black bg-opacity-60"},[p("div",rt,[d(r($),{class:"w-full text-3xl text-white relative"},{default:h(()=>[d(f,{class:"absolute -left-1.5"})]),_:1}),d(r($),{class:"w-full text-3xl text-white relative"},{default:h(()=>[d(v,{class:"absolute -left-1.5"})]),_:1})])],512)):y("",!0)],2)]),_:1},8,["show"])}}};var ct=H(at,[["__scopeId","data-v-775ec421"]]);const F=Symbol("Comlink.proxy"),it=Symbol("Comlink.endpoint"),lt=Symbol("Comlink.releaseProxy"),A=Symbol("Comlink.thrown"),G=e=>typeof e=="object"&&e!==null||typeof e=="function",ut={canHandle:e=>G(e)&&e[F],serialize(e){const{port1:t,port2:s}=new MessageChannel;return X(e,t),[s,[s]]},deserialize(e){return e.start(),J(e)}},dt={canHandle:e=>G(e)&&A in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},Y=new Map([["proxy",ut],["throw",dt]]);function X(e,t=self){t.addEventListener("message",function s(n){if(!n||!n.data)return;const{id:a,type:o,path:c}=Object.assign({path:[]},n.data),i=(n.data.argumentList||[]).map(x);let l;try{const u=c.slice(0,-1).reduce((f,v)=>f[v],e),_=c.reduce((f,v)=>f[v],e);switch(o){case"GET":l=_;break;case"SET":u[c.slice(-1)[0]]=x(n.data.value),l=!0;break;case"APPLY":l=_.apply(u,i);break;case"CONSTRUCT":{const f=new _(...i);l=ft(f)}break;case"ENDPOINT":{const{port1:f,port2:v}=new MessageChannel;X(e,v),l=mt(f,[f])}break;case"RELEASE":l=void 0;break;default:return}}catch(u){l={value:u,[A]:0}}Promise.resolve(l).catch(u=>({value:u,[A]:0})).then(u=>{const[_,f]=N(u);t.postMessage(Object.assign(Object.assign({},_),{id:a}),f),o==="RELEASE"&&(t.removeEventListener("message",s),q(t))})}),t.start&&t.start()}function pt(e){return e.constructor.name==="MessagePort"}function q(e){pt(e)&&e.close()}function J(e,t){return O(e,[],t)}function C(e){if(e)throw new Error("Proxy has been released and is not useable")}function O(e,t=[],s=function(){}){let n=!1;const a=new Proxy(s,{get(o,c){if(C(n),c===lt)return()=>M(e,{type:"RELEASE",path:t.map(i=>i.toString())}).then(()=>{q(e),n=!0});if(c==="then"){if(t.length===0)return{then:()=>a};const i=M(e,{type:"GET",path:t.map(l=>l.toString())}).then(x);return i.then.bind(i)}return O(e,[...t,c])},set(o,c,i){C(n);const[l,u]=N(i);return M(e,{type:"SET",path:[...t,c].map(_=>_.toString()),value:l},u).then(x)},apply(o,c,i){C(n);const l=t[t.length-1];if(l===it)return M(e,{type:"ENDPOINT"}).then(x);if(l==="bind")return O(e,t.slice(0,-1));const[u,_]=K(i);return M(e,{type:"APPLY",path:t.map(f=>f.toString()),argumentList:u},_).then(x)},construct(o,c){C(n);const[i,l]=K(c);return M(e,{type:"CONSTRUCT",path:t.map(u=>u.toString()),argumentList:i},l).then(x)}});return a}function _t(e){return Array.prototype.concat.apply([],e)}function K(e){const t=e.map(N);return[t.map(s=>s[0]),_t(t.map(s=>s[1]))]}const Q=new WeakMap;function mt(e,t){return Q.set(e,t),e}function ft(e){return Object.assign(e,{[F]:!0})}function N(e){for(const[t,s]of Y)if(s.canHandle(e)){const[n,a]=s.serialize(e);return[{type:"HANDLER",name:t,value:n},a]}return[{type:"RAW",value:e},Q.get(e)||[]]}function x(e){switch(e.type){case"HANDLER":return Y.get(e.name).deserialize(e.value);case"RAW":return e.value}}function M(e,t,s){return new Promise(n=>{const a=gt();e.addEventListener("message",function o(c){!c.data||!c.data.id||c.data.id!==a||(e.removeEventListener("message",o),n(c.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:a},t),s)})}function gt(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function vt(){return new Worker("https://cdn.jsdelivr.net/gh/moomfe/tools-cdn@1.1.0/assets/svg-minimizer.f598076d.js",{type:"module"})}function ht(e,t){const s=_e(async n=>{const a=e.code;let o={};if(!a)return o;const c=new vt;n(()=>{c.terminate()});const i=J(c),l=await new i;try{await l.parse(a),o=await l.optimize()}catch(u){console.error(u.message)}finally{c.terminate()}return o},{});S(s,({originalSvgBase64:n,compressSvgCode:a,compressSvgBase64:o})=>{Object.assign(e,{base64:n||""}),Object.assign(t,{code:a||"",base64:o||""})})}const bt={class:"bg-n-card transition-bg-color duration-colors"},wt={class:"p-4"},yt={class:"p-4"},xt={class:"p-4"},Et={setup(e){const t=P({code:"",base64:""}),s=P({code:"",base64:""}),n=P({contrastMode:j});function a(o){Object.assign(t,{code:o,base64:""}),Object.assign(s,{code:"",base64:""})}return ht(t,s),(o,c)=>(m(),g("div",bt,[p("div",wt,[d(be,{"onUpdate:value":a})]),d(r(T),{class:"my-0"}),p("div",yt,[d(Ee,{contrastMode:r(n).contrastMode,"onUpdate:contrastMode":c[0]||(c[0]=i=>r(n).contrastMode=i)},null,8,["contrastMode"])]),d(r(T),{class:"my-0"}),p("div",xt,[d(ct,{"contrast-mode":r(n).contrastMode,"original-svg":r(t),"compress-svg":r(s)},null,8,["contrast-mode","original-svg","compress-svg"])])]))}};export{Et as default};
